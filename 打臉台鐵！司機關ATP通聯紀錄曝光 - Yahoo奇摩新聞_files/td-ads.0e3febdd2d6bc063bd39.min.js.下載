webpackJsonp([94],{1369:function(t,e,s){t.exports={controllerViews:{AdPrefetch:s(594),ComboAd:s(595),DockedAds:s(3030),SponsoredMomentsFallback:s(3032),Ad:s(529)},stores:{AdStore:s(30)}}},3030:function(t,e,s){"use strict";t.exports=s(4)({displayName:"DockedAds",mixins:[s(11)],propTypes:{className:s(0).string,children:s(0).array.isRequired,target:s(0).string,targetIndex:s(0).number,targetSelector:s(0).string},statics:{initializeAction:s(3031),storeListeners:[s(30)]},contextTypes:{renderTarget:s(0).object},getInitialState:function(t){return this.adStore=this.getStore(s(30)),this.routeStore=this.getStore("RouteStore"),{isFixed:!1,expanded:!1,isFetching:!1,childReady:this.adStore.getChildCompositeReady(this.props.id),childCount:this.props.children.length,right:0,offset:0}},getChildPositions:function(){var t=[];return this.props.children.forEach(function(e){"td-ads"===e.bundleName&&t.push(e.props.pos)}),t},commentExpand:function(t){var e=this,n=t.offsetHeight>250,o=!1,i=this.props.children.length;if(e.state.expanded!==n){var r=e.getChildPositions();t.offsetHeight<650&&(r.splice(1),i=1),t.offsetHeight>250?(o=!0,n&&setImmediate(function(){context.executeAction(s(160),{positions:r}),e._repositionAd(null,!0)})):n=!1}e.setState({expanded:n,isFetching:o,childCount:i})},onChange:function(t){var e=this,n=this.routeStore,o=n.getCurrentNavigate()||{},i=s(2)(o,["params","collapseContent"],!1),r=null;if("childCompositeReady"===t.type&&this.props.id===t.instanceId&&this.setState({childReady:!0}),this.state.expanded&&"task_complete"===t.type&&this.setState({isFetching:!1}),this.props.target){var a=document.getElementsByClassName(this.props.target);a&&a.length>this.props.targetIndex&&(r=a[this.props.targetIndex])}else if(this.props.targetSelector){var p=this.context.renderTarget;r=document.querySelector("#"+p.elementId+" "+this.props.targetSelector)}r&&(i||"comments_expand"!==t.type?("newpage"===t.type||t.newpage)&&(setImmediate(function(){e.props.children.forEach(function(t){"td-ads"===t.bundleName&&s(27).nukePosition(t.props.pos)})}),this.setState({expanded:!1})):setImmediate(function(){e.commentExpand(r)}))},componentDidMount:function(){s(41)("scroll",this._repositionAd,this)},componentWillUnmount:function(){s(225)("scroll",this._repositionAd)},_repositionAd:function(t,e){var n=this.props.targetIndex,o=s(9).findDOMNode(this.refs["adWrapper"+n]),i=s(9).findDOMNode(this.refs["adInnerWrapper"+n]),r=null;if(this.props.target){var a=document.getElementsByClassName(this.props.target);a&&a.length>n&&(r=a[n])}else if(this.props.targetSelector){var p=this.context.renderTarget;r=document.querySelector("#"+p.elementId+" "+this.props.targetSelector)}if(o&&i&&r){var d=i.offsetHeight,h=0;if(d>100||e){var c=r.getBoundingClientRect(),l=o.getBoundingClientRect(),m=!1,g=document.documentElement.clientWidth||window.innerWidth;if(c.top<88?c.bottom>=d+88?l.top<88&&(m=!0):h=c.height-d-(l.top-c.top):l.top<88?c.top>l.top?h=c.top-l.top:m=!0:c.top>l.top&&(h=c.top-l.top),m){this.setState({isFixed:!0,right:g-i.getBoundingClientRect().right})}else this.setState({isFixed:!1,offset:h})}}},render:function(){var t,e=this;if(e.state.childReady){t=(this.getStore("PageStore").getComposite(this.props.id)||{}).components}else t=this.props.children.map(function(t){if(e.state.childReady||"td-ads"===t.bundleName)return t;return{bundleName:"tdv2-applet-swisschamp",name:"Empty",props:{}}});t.splice(this.state.childCount);var n,o=this.props.targetIndex?this.props.targetIndex:0,i=[],r=[],a=0;for(n=0;n<t.length;n++)t[n].props=t[n].props||{},t[n].props.id=t[n].props.id||"dockedAds-"+n,t[n].props.key=t[n].props.key||"dockedAds-"+n;for(n=0;n<t.length&&"td-ads"===t[n].bundleName;n++){var p=this.adStore.getPosConfig(t[n].props.pos)||{};p&&p.h&&(a+=parseInt(p.h,10)),i.push(t[n])}i.length>0&&i.length<t.length&&(r=t.slice(i.length));var d=this.props.className;d?d+=" ad-inner-wrapper":d="ad-inner-wrapper";var h={};this.state.isFixed?h={position:"fixed",right:this.state.right+"px",top:"88px"}:0!==this.state.offset&&(h={transform:"translate3d(0px, "+this.state.offset+"px, 0px)"});var c="ad-wrapper",l={};return this.state.expanded||(c+=" D(n)"),(!this.state.expanded||this.state.isFetching)&&r.length>0&&(l.height=a+"px"),s(1).createElement("div",{className:c,ref:"adWrapper"+o},s(1).createElement("div",{className:this.props.className,style:h,ref:"adInnerWrapper"+o},s(1).createElement("div",{style:l},s(1).createElement(s(204).Composite,{components:i})),s(1).createElement(s(204).Composite,{components:r})))}})},3031:function(t,e,s){t.exports=function(t,e,n){var o=e.componentProps.id;o?t.executeAction(s(153),{parentComponent:{bundleName:"td-ads",name:"DockedAds"},name:o,components:e.componentProps.children},n):n&&n()}},3032:function(t,e,s){"use strict";t.exports=s(4)({displayName:"SponsoredMomentsFallback",mixins:[s(11)],getInitialState:function(){return this.sponsoreMomentsStore=this.getStore("SponsoredMomentsStore"),this.getState()},onChange:function(){var t=this.getState();t.smadShown!==this.state.smadShown&&this.setState(t)},getState:function(){return{smadShown:(this.sponsoreMomentsStore&&this.sponsoreMomentsStore.getState()||[]).length>0}},render:function(){return this.state.smadShown?s(1).createElement("div",null):s(1).createElement(s(529),this.props)}})}});